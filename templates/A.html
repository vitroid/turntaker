<html>
    <head>
        <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
        <style>
            {% include "main.css" %}
        </style>
        <script>
            {% include "main.js" %}
            // 自動アップデートは要らない。
            // var intervalId = setInterval(function() {update_count()}, 3000)
        </script>
    </head>
    <body>
        <div class="vcontainer">
            <input value="{{title}}" type="text" id="title" />
            <div class="container">
                <div class="vcontainer">
                    <h2>
                        現在の順番
                    </h2>
                    <div class="counter" id="count">
                        {{count}}
                    </div>
                    <div class="container">
                        <div  class="button" onclick="decrement()">
                            <button>
                                –
                            </button>
                        </div>
                        <a href="{{baseurl}}/R/{{occasion_id}}">
                            <div id="qrcode" class="container"></div>
                        </a>
                        <script type="text/javascript">
                            var qrcode = new QRCode(document.getElementById("qrcode"), {
                                text: "{{baseurl}}/R/{{occasion_id}}",
                                width: 128,
                                height: 128,
                                colorDark : "#442",
                                colorLight : "#eee",
                                correctLevel : QRCode.CorrectLevel.H
                            });
                        </script>
                        <div class="button" onclick="increment()">
                            <button>
                                +
                            </button>
                        </div>
                    </div>
                <!-- </div>
                <div class="vcontainer2"> -->
                    <!-- <h2>
                        次の番号
                    </h2>
                    <div class="counter" id="waiting">
                        {{waiting}}
                    </div> -->
                </div>
            </div>
        </div>
        <script>
// Get the input box
let input = document.getElementById('title');

// Init a timeout variable to be used below
let timeout = null;

// Listen for keystroke events
input.addEventListener('keyup', function (e) {
    // Clear the timeout if it has already been set.
    // This will prevent the previous task from executing
    // if it has been less than <MILLISECONDS>
    clearTimeout(timeout);

    // Make a new timeout set to go off in 1000ms (1 second)
    timeout = setTimeout(function () {
        fetch("{{BASEURL}}/t/{{admin}}/"+input.value)
        console.log('Input Value:', input.value);
    }, 1000);
});

        </script>
    </body>
</html>
